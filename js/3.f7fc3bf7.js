(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[3],{"1dbc":function(t,e,n){},"2a7b":function(t,e,n){"use strict";var s=n("dc2b"),o=n.n(s);o.a},"2beb":function(t,e,n){"use strict";var s=n("f31d"),o=n.n(s);o.a},5856:function(t,e,n){"use strict";var s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("span",{attrs:{title:t.timeStr}},[t._v(t._s(t.text))])},o=[],i=n("60a3"),a=function(t,e,n,s){var o,i=arguments.length,a=i<3?e:null===s?s=Object.getOwnPropertyDescriptor(e,n):s;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(t,e,n,s);else for(var r=t.length-1;r>=0;r--)(o=t[r])&&(a=(i<3?o(a):i>3?o(e,n,a):o(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};let r=class extends i["c"]{data(){const{refresh:t,text:e,timeStr:n}=this.calculateTimeDiff();return setTimeout(()=>this.refresh(),1e3*t),{timeStr:n,text:e}}calculateTimeDiff(){const{ts:t}=this.$props,e=new Date(t).toLocaleString(),n=Math.floor((Date.now()-t)/1e3);if(n<60)return{timeStr:e,refresh:5,text:n+"s"};const s=Math.floor(n/60);if(s<60)return{timeStr:e,refresh:30,text:s+"m"};const o=Math.floor(n/3600);if(o<24)return{timeStr:e,refresh:300,text:o+"h"};const i=Math.floor(n/3600/24);if(i<35)return{timeStr:e,refresh:1800,text:i+"d"};const a=Math.floor(n/3600/24/30);return{timeStr:e,refresh:1800,text:a+"mo"}}refresh(){const{refresh:t,text:e,timeStr:n}=this.calculateTimeDiff();this.text=e,this.timeStr=n,setTimeout(()=>this.refresh(),1e3*t)}};r=a([Object(i["a"])({props:{ts:Number}})],r);var c=r,l=c,m=n("2877"),u=Object(m["a"])(l,s,o,!1,null,null,null);e["a"]=u.exports},c9ac:function(t,e,n){"use strict";n.r(e);var s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"diff-table-wrapper"},[n("table",{staticClass:"diff-table"},[n("tbody",{attrs:{"data-diff-root":"true"}},t._l(t.changes,(function(e){return n("tr",{key:e.idx,class:{added:e.added,removed:e.removed,line:!0},attrs:{"data-idx":e.idx}},[n("td",{staticClass:"line-number",attrs:{"data-txt":e.leftLineNumber}}),n("td",{staticClass:"line-number",attrs:{"data-txt":e.rightLineNumber}}),n("td",{staticClass:"symbol"},[t.addCommentIdx===e.idx?n("q-icon",{staticClass:"add-comment-button text-primary",attrs:{name:"add_comment"},nativeOn:{click:function(e){return e.stopPropagation(),t.openCommentInput(e)}}}):t._e()],1),n("decoration",{attrs:{hightLights:e.hightLights}})],1)})),0)])])},o=[],i=n("60a3"),a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("td",{staticClass:"code"},t._l(t.hls,(function(e,s){return n("span",{key:s,class:e.css,attrs:{"data-length":e.value.length}},[t._v(t._s(e.value)),t._l(e.comments,(function(t){return n("comment",{key:t.id,attrs:{c:t}})}))],2)})),0)},r=[],c=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("span",[t.c.minimize?n("q-icon",{class:"comment-status-icon comment-state-"+t.c.state,attrs:{name:"comment"},nativeOn:{click:function(e){return e.stopPropagation(),t.toggleCommentMinimizeStatus(e)},mouseover:function(e){e.stopPropagation(),t.showCommentBox=!0},mouseout:function(e){e.stopPropagation(),t.showCommentBox=!1}}}):t._e(),!t.c.minimize||t.showCommentBox?n("div",{staticClass:"comment-box",style:{top:t.top+"px",right:t.right+"px"},on:{mousedown:t.mousedown,mouseup:t.mouseup,mousemove:t.mousemove}},[n("svg",{staticClass:"commen-line",style:{top:t.svg.t+"px",right:t.svg.r+"px"},attrs:{height:t.svg.h,width:t.svg.w,"pointer-events":"none"}},[n("line",{staticStyle:{stroke:"rgba(255,225,0,0.8)","stroke-width":"2"},attrs:{x1:t.svg.x1,y1:t.svg.y1,x2:t.svg.x2,y2:t.svg.y2}})]),t.moving?n("div",{staticClass:"moving-bg"}):t._e(),n("q-card",{staticStyle:{width:"30em"}},[n("q-list",[t.c.message?n("q-item",[n("q-item-section",{attrs:{avatar:""}},[n("q-avatar",{attrs:{rounded:""}},[n("img",{attrs:{src:t.c.avatarUrl}})])],1),n("q-item-section",[n("q-item-label",[n("span",[t._v("@"+t._s(t.c.login))]),n("span",[t._v(" ")]),n("time-from-now",{attrs:{ts:t.c.at}}),n("a",{staticClass:"goto-github",attrs:{href:t.githubUrl+t.c.id,target:"_blank",title:"goto Github"}},[n("q-icon",{attrs:{name:"fab fa-github"}})],1)],1),n("q-item-label",{domProps:{innerHTML:t._s(t.c.html)}})],1)],1):t._e(),t._l(t.c.replies,(function(e){return n("q-item",{key:e.id},[n("q-item-section",{attrs:{avatar:""}},[n("q-avatar",{attrs:{rounded:""}},[n("img",{attrs:{src:e.avatarUrl}})])],1),n("q-item-section",[n("q-item-label",[n("span",[t._v("@"+t._s(e.login))]),n("span",[t._v(" ")]),n("time-from-now",{attrs:{ts:e.at}}),n("a",{staticClass:"goto-github",attrs:{href:t.githubUrl+e.id,target:"_blank",title:"goto Github"}},[n("q-icon",{attrs:{name:"fab fa-github"}})],1),n("q-icon",{staticClass:"delete-comment",attrs:{name:"delete","data-id":e.id,title:"delete"},nativeOn:{click:function(e){return e.stopPropagation(),t.deleteComment(e)}}})],1),n("q-item-label",{domProps:{innerHTML:t._s(e.html)}})],1)],1)})),t.c.id>0?n("q-separator"):t._e(),n("q-item",[n("q-item-section",[n("q-input",{attrs:{autogrow:"",type:"textarea",placeholder:0===t.c.id?"New Comment":"Reply","hide-underline":""},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:e.ctrlKey?e.shiftKey||e.altKey||e.metaKey?null:(e.preventDefault(),t.inputSubmit(e)):null},focus:function(e){t.inputFocused=!0},blur:function(e){t.inputFocused=!1}},model:{value:t.newCommentMessage,callback:function(e){t.newCommentMessage=e},expression:"newCommentMessage"}})],1)],1),t.inputFocused||t.newCommentMessage||0===t.c.id?n("q-item",[n("q-card-actions",[n("q-btn",{attrs:{color:"primary",label:"Submit",size:"sm"},on:{click:t.inputSubmit}}),n("q-btn",{attrs:{label:"Cancle",size:"sm"},on:{click:t.inputCancle}})],1)],1):t._e()],2),n("q-separator"),t.c.id>0?n("q-card-actions",[n("q-btn",{attrs:{flat:"",icon:"transit_enterexit"},on:{click:function(e){return e.stopPropagation(),t.toggleCommentMinimizeStatus(e)}}}),n("q-btn",{attrs:{flat:"",icon:"delete","data-id":t.c.id},on:{click:function(e){return e.stopPropagation(),t.deleteComment(e)}}}),n("q-select",{staticStyle:{"margin-left":"auto"},attrs:{options:t.commentStateOptions,"hide-underline":""},model:{value:t.commentState,callback:function(e){t.commentState=e},expression:"commentState"}})],1):t._e()],1)],1):t._e()],1)},l=[],m=n("8be0"),u=n("5856"),d=function(t,e,n,s){var o,i=arguments.length,a=i<3?e:null===s?s=Object.getOwnPropertyDescriptor(e,n):s;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(t,e,n,s);else for(var r=t.length-1;r>=0;r--)(o=t[r])&&(a=(i<3?o(a):i>3?o(e,n,a):o(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},h=function(t,e,n,s){function o(t){return t instanceof n?t:new n((function(e){e(t)}))}return new(n||(n=Promise))((function(n,i){function a(t){try{c(s.next(t))}catch(e){i(e)}}function r(t){try{c(s["throw"](t))}catch(e){i(e)}}function c(t){t.done?n(t.value):o(t.value).then(a,r)}c((s=s.apply(t,e||[])).next())}))};const f=50,p=-30;let g=class extends i["c"]{get store(){const t=this.$store;return t}get changableFields(){const t={state:this.c.state,line:this.c.line,detailPos:this.c.detailPos,boxPos:this.c.boxPos,minimize:this.c.minimize};return{message:this.c.message,cid:this.c.id,fragment:t}}get githubUrl(){const{state:{pullRequest:{owner:t,repo:e,id:n}}}=this.store;return`https://github.com/${t}/${e}/pull/${n}#discussion_r`}get avatarUrl(){return this.store.state.info.avatarUrl}data(){return{moving:!1,inputFocused:!1,top:f,right:p,newCommentMessage:"",commentState:m["a"].Active,commentStateOptions:[{label:"Active",value:m["a"].Active},{label:"Pending",value:m["a"].Pending},{label:"Resolved",value:m["a"].Resolved},{label:"Won't Fix",value:m["a"].WontFix},{label:"Closed",value:m["a"].Closed}],showCommentBox:!1}}get svg(){const{top:t,right:e}=this,n=Math.abs(e),s=Math.abs(t),o=Math.min(0,-t),i=Math.min(0,-e),a=0!==o?n:0,r=0!==o?0:n,c=0===i?s:0,l=0===i?0:s;return{w:n,h:s,t:o,r:i,x1:a,x2:r,y1:c,y2:l}}onCommentStateChange(t,e){if(t===this.c.state)return;const{changableFields:n}=this,s=Object.assign(Object.assign({},n),{fragment:Object.assign(Object.assign({},n.fragment),{state:t})});this.store.dispatch("pullRequest/updateComment",s)}cancelNewComment(){this.store.dispatch("pullRequest/cancelNewComment")}deleteComment(t){const e=+t.target.dataset.id;e&&this.store.dispatch("pullRequest/deleteComment",e)}toggleCommentMinimizeStatus(){const{changableFields:t}=this,e=!t.fragment.minimize;!0===e&&(this.showCommentBox=!1);const n=Object.assign(Object.assign({},t),{fragment:Object.assign(Object.assign({},t.fragment),{minimize:e})});this.store.dispatch("pullRequest/updateComment",n)}submitNewComment(){const{top:t,right:e,newCommentMessage:n}=this;this.store.dispatch("pullRequest/submitNewComment",{top:t,right:e,newCommentMessage:n})}replyComment(){return h(this,void 0,void 0,(function*(){if(this.c.id<=0)return;const{newCommentMessage:t}=this;yield this.store.dispatch("pullRequest/replyComment",{replyToId:this.c.id,message:t}),this.cancleReply()}))}cancleReply(){this.newCommentMessage=""}inputSubmit(){this.c.id>0?this.replyComment():this.submitNewComment()}inputCancle(){this.c.id>0?this.cancleReply():this.cancelNewComment()}mousedown(t){let e=t.target,n=!1;for(let s=0;s<10;s++){if(!e)break;if(e.classList.contains("q-list")){n=!0;break}e=e.parentElement}n||(this.moving=!0,this.mouseStartPos={x:t.clientX,y:t.clientY,top:this.top,right:this.right})}mouseup(){if(this.mouseStartPos=void 0,this.moving=!1,this.c.id>0){const t=this.c.boxPos||{right:void 0,top:void 0},{right:e,top:n}=this;if(e!==t.right||n!==t.top){const{changableFields:t}=this,s=Object.assign(Object.assign({},t.fragment),{boxPos:{right:e,top:n}});this.store.dispatch("pullRequest/updateComment",Object.assign(Object.assign({},t),{fragment:s}))}}}mousemove(t){if(!this.mouseStartPos)return;t.preventDefault(),t.stopPropagation();const{x:e,y:n,top:s,right:o}=this.mouseStartPos;this.right=-(t.clientX-e)+o,this.top=t.clientY-n+s}created(){if(this.c.boxPos){const{right:t,top:e}=this.c.boxPos;this.right=t||p,this.top=e||f,this.commentState=this.c.state}}};d([Object(i["b"])(Object)],g.prototype,"c",void 0),d([Object(i["d"])("commentState")],g.prototype,"onCommentStateChange",null),g=d([Object(i["a"])({components:{TimeFromNow:u["a"]}})],g);var b=g,v=b,C=(n("2a7b"),n("2877")),y=n("eebe"),x=n.n(y),w=n("0016"),O=n("05c0"),S=n("f09f"),q=n("1c1c"),_=n("66e5"),j=n("4074"),P=n("cb32"),R=n("0170"),k=n("eb85"),M=n("27f9"),I=n("4b7e"),L=n("9c40"),N=n("ddd8"),E=Object(C["a"])(v,c,l,!1,null,null,null),D=E.exports;x()(E,"components",{QIcon:w["a"],QTooltip:O["a"],QCard:S["a"],QList:q["a"],QItem:_["a"],QItemSection:j["a"],QAvatar:P["a"],QItemLabel:R["a"],QSeparator:k["a"],QInput:M["a"],QCardActions:I["a"],QBtn:L["a"],QSelect:N["a"]});var Q=function(t,e,n,s){var o,i=arguments.length,a=i<3?e:null===s?s=Object.getOwnPropertyDescriptor(e,n):s;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(t,e,n,s);else for(var r=t.length-1;r>=0;r--)(o=t[r])&&(a=(i<3?o(a):i>3?o(e,n,a):o(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};let T=class extends i["c"]{get store(){const t=this.$store;return t}get hls(){const{hightLights:t}=this;return t.map(({type:t,value:e,commentIds:n,commentToDisplay:s})=>{const o={value:e,css:{[t]:!0},comments:[]};if(n){o.css.comment=!0;for(const t of n)o.css["comment-"+t]=!0}return s&&(o.comments=s),o})}};T=Q([Object(i["a"])({props:{hightLights:Array},components:{Comment:D}})],T);var $=T,z=$,F=(n("2beb"),Object(C["a"])(z,a,r,!1,null,null,null)),A=F.exports,U=function(t,e,n,s){var o,i=arguments.length,a=i<3?e:null===s?s=Object.getOwnPropertyDescriptor(e,n):s;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(t,e,n,s);else for(var r=t.length-1;r>=0;r--)(o=t[r])&&(a=(i<3?o(a):i>3?o(e,n,a):o(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};function B(t){const{commonAncestorContainer:e}=t;let n=e;for(let s=0;s<5;s++){if(!n)return!1;if("tbody"===n.localName)return!!n.dataset.diffRoot;n=n.parentElement}return!1}function K(t){if(!t)return 0;if(t.nodeType===Node.TEXT_NODE){let e=t.parentElement&&t.parentElement.previousSibling,n=0;while(e){const t=+(e.dataset.length||0);n+=t,e=e.previousSibling}return n}return 0}function X(t){for(let e=0;e<5;e++){if(!t)return-1;if("tr"===t.localName){const{idx:e}=t.dataset;return e?+e:-1}t=t.parentElement}return-1}function G(t){const e=getSelection();if(!e)return;if(0===e.rangeCount)return;const n=e.getRangeAt(0);if(n.collapsed)return;if(!B(n))return;const{startContainer:s,endContainer:o}=n;let{startOffset:i,endOffset:a}=n;i+=K(s),a+=K(o);const r=X(s),c=X(o);if(r<0||c<0)return;const{activeChanges:l}=t,m=l[r],u=l[c];let d=!1,h=!1;for(let v=r;v<=c;v++)l[v].added&&(d=!0),l[v].removed&&(h=!0);if(d&&h)return;const{selectedStartCommit:f,selectedEndCommit:p}=t,g=h?f:p,b={sha:g,startLine:(h?m.leftLineNumber:m.rightLineNumber)||-1,startOffset:i,endLine:(h?u.leftLineNumber:u.rightLineNumber)||-1,endOffset:a,startIdx:r,endIdx:c};return b}let H=class extends i["c"]{get store(){const t=this.$store;return t}data(){return{addCommentIdx:-1}}beforeCreate(){const{owner:t,repo:e,pullId:n}=this.$route.params;this.$store.dispatch("pullRequest/load",{owner:t,repo:e,pullId:n})}mounted(){document.addEventListener("selectionchange",this.checkSelection)}destroyed(){document.removeEventListener("selectionchange",this.checkSelection)}openCommentInput(){this.store.dispatch("pullRequest/openCommentInput",this.selection);const t=getSelection();t&&t.removeAllRanges()}checkSelection(){const t=G(this.store.state.pullRequest);if(!t)return this.selection=void 0,void(this.addCommentIdx=-1);this.addCommentIdx=t.endIdx,this.selection=t}get changes(){const{activeChanges:t}=this.store.state.pullRequest;return t}};H=U([Object(i["a"])({components:{Decoration:A}})],H);var J=H,W=J,Y=(n("f2e5"),Object(C["a"])(W,s,o,!1,null,null,null));e["default"]=Y.exports;x()(Y,"components",{QIcon:w["a"]})},dc2b:function(t,e,n){},f2e5:function(t,e,n){"use strict";var s=n("1dbc"),o=n.n(s);o.a},f31d:function(t,e,n){}}]);